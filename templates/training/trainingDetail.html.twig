{% extends 'base.html.twig' %}

{% block title %}Formation{% endblock %}


{% block body %}

    <h1>Formation {{ training.title }}</h1>
    <a href="{{ path('app_training') }}">Retour</a>

    <br><br>

    {# {% if is_granted('ROLE_ADMIN') %} #}
    {% if app.user %}
    
        <p>Infos</p>
        <ul>
            <li>
                Titre: {{ training.title }}&nbsp; {% if app.user %}<a href="{{ path('app_editTraining', {'id': training.id }) }}">Editer</a>{% endif %}
            </li>
            <li>Nombre de sessions en cours:</li>
            <li>Nombre de sessions à venir:</li>
        </ul>


    {% else %}

        <p>Vous n'avez pas l'autorisation de voir ces infos</p>

    {% endif %}


    <h2>Sessions</h2>

    <h3>Prochainement</h3>

        {% if app.user %}
            <table id="sessionsTable" class="display">
                <thead>
                    <tr>    
                        <th>Titre</th>
                        <th>Début</th>
                        <th>Fin</th>
                        <th>Places</th>
                    </tr>
                </thead>
                <tbody>
                    {% for incomingSession in incomingSessions %}
                    <tr>    
                        <td>
                            <a href="{{ path('app_editSession', {id: incomingSession.id}) }}">
                                {{ incomingSession.title }}
                            </a>
                        </td>
                        <td>{{ incomingSession.beginDate | date('m/d/Y') }}</td>
                        <td>{{ incomingSession.endDate | date('m/d/Y') }}</td>
                        <td>{{ incomingSession.nbrPlaces }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>

        {% else %}
            <p>Accès non autorisé<p> 
        {% endif %}

    
    <h3>En cours</h3>

        {# {% for ongoingSession in ongoingSessions %}
            {{ dump(ongoingSession) }}
        {% endfor %} #}

        {% if app.user %}
            <table id="sessionsTable2">
                <thead>
                    <tr>    
                        <th>Titre</th>
                        <th>Début</th>
                        <th>Fin</th>
                        <th>Places</th>
                    </tr>
                </thead>
                <tbody>
                    {% for ongoingSession in ongoingSessions %}
                    <tr>    
                        <td>
                            <a href="{{ path('app_editSession', {id: ongoingSession.id}) }}">
                                {{ ongoingSession.title }}
                            </a>
                        </td>
                        <td>{{ ongoingSession.beginDate | date('m/d/Y') }}</td>
                        <td>{{ ongoingSession.endDate | date('m/d/Y') }}</td>
                        <td>{{ ongoingSession.nbrPlaces }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>

        {% else %}
            <p>Accès non autorisé<p> 
        {% endif %}
        




    <h3>Passés</h3>

        {# {% for passedSession in passedSessions %}
            {{ dump(passedSession) }}
        {% endfor %} #}

        {% if app.user %}
            <table id="sessionsTable3">
                <thead>
                    <tr>    
                        <th>Titre</th>
                        <th>Début</th>
                        <th>Fin</th>
                        <th>Places</th>
                    </tr>
                </thead>
                <tbody>
                    {% for passedSession in passedSessions %}
                    <tr>    
                        <td>
                            <a href="{{ path('app_editSession', {id: passedSession.id}) }}">
                                {{ passedSession.title }}
                            </a>
                        </td>
                        <td>{{ passedSession.beginDate | date('m/d/Y') }}</td>
                        <td>{{ passedSession.endDate | date('m/d/Y') }}</td>
                        <td>{{ passedSession.nbrPlaces }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>


            <script>
                let table = new DataTable('#sessionsTable', {
                    paging: false,
                    searching: false,
                    // scrollY: 400
                });
                let table2 = new DataTable('#sessionsTable2', {
                    paging: false,
                    searching: false,
                    // scrollY: 400
                });
                let table3 = new DataTable('#sessionsTable3', {
                    paging: false,
                    searching: false,
                    // scrollY: 400
                });

            </script>

        {% else %}
                <p>Accès non autorisé<p> 
        {% endif %}




    <br>
    <a href="{{ path('app_addSession', { 'idTraining': training.id }) }}">Ajouter une Session</a>
        


{% endblock %}